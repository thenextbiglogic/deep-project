var fs=require("fs");const utils={Logger:require("../js/app-log.util.min"),Constants:require("../js/app-contants.util.min"),Exception:require("../js/app-exception.util.min")},route=require("../js/app.route.min"),express=require("express"),port=process.env.port||1304,app=express(),viewEngine=utils.Constants.view.engine,path=require("path"),ejs=require("ejs-locals");var version=utils.Constants.Server.Properties.version,name=utils.Constants.Server.Properties.Name,project={name:utils.Constants.Project.Properties.Name},viewEngineSet=utils.Constants.ViewEngine.Properties.IsSet,dirname=__dirname,allowedRoutes=[],routeList=[],server={getVersion:function(){return this.version},getExpress:function(){return this.app()},getName:function(){return this.name},configure:{app:function(e){var t=utils.Exception.Handle(e);t.Status&&t.Message===utils.Constants.Empty?(e.route||(e.route=utils.Constants.appRoot),e.dirname&&(dirname=e.dirname),e.useViewEngine&&(utils.Logger.info(utils.Constants.ViewEngine.Messages[0].replace("{0}",dirname)),this.views(dirname)),utils.Logger.info(utils.Constants.Server.Messages[1].replace("{0}",server.name)),route.configure(),server.Serve(e),e.port||(e.port=port),app.listen(e.port,()=>{utils.Logger.info(utils.Constants.Server.Messages[0].replace("{0}",server.name)),utils.Logger.info("Listening on port:"+e.port)})):utils.Logger.info(utils.Constants.Server.Messages[6].replace("{0}",name).replace("{1}",arguments[0]))},views:function(e){allowedRoutes=utils.Constants.appRoutes.allowed(e);var t=utils.Exception.Handle(app);t.Status&&t.Message===utils.Constants.Empty?viewEngineSet||(utils.Logger.info(allowedRoutes.views),app.use(express.static(utils.Constants.paths.static)),app.set(utils.Constants.view.base,allowedRoutes[utils.Constants.view.base]),app.engine(utils.Constants.view.type,ejs),app.set(utils.Constants.view.engine,utils.Constants.view.type),viewEngineSet=!0,utils.Constants.ViewEngine.Properties.IsSet=viewEngineSet):utils.Logger.error(utils.Constants.Server.Message[4].replace("{0}",name))}}};Object.defineProperty(server,"version",{get:function(){return version},IEnumerable:!0,configurable:!1}),Object.defineProperty(server,"name",{get:function(){return name},set:function(e){server.name=e},IEnumerable:!0,configurable:!1}),server.Serve=function(e){e.route===utils.Constants.appRoot?(app.route(e.route).get(function(e,t){var s=route.get("home");utils.Logger.info(e.url),utils.Logger.info(s.name+","+s.LastAccessed),s.actions.get(e,t,dirname)}),app.route("/node").get(function(e,t){var s=route.get("node");utils.Logger.info(e.url),utils.Logger.info(s.name+","+s.LastAccessed),s.actions.get(e,t,dirname)}),app.route("/home").get(function(e,t){var s=route.get("home");utils.Logger.info(e.url),utils.Logger.info(s.name+","+s.LastAccessed),s.actions.get(e,t,dirname)})):app.get(e.route,function(t,s){var n=utils.Constants.Server.Message[6];utils.Logger.info(),!viewEngineSet&&e.useViewEngine?(n+=utils.Constants.ViewEngine.Message[1],utils.Logger.info(n),s.send(n)):e.useViewEngine?s.render(path.join(dirname,utils.Constants.paths.public.views)+"index.view.ejs",{title:"Home",name:name,data:{Message:n,Time:(new Date).toString()}}):s.send(n)})},module.exports=server;